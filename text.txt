Всем привет.

Меня зовут Андрей Григорьев, и я не занимаюсь информационной безопасностью в
Яндексе.

---

Однако, многие из тех, кто сидит в этом зале не в первый раз, знают меня как
администратора команды WildRide. Это мой 5-й RuCTF. 4 года назад на нашу
кафедру внезапно зашел проректор по научной работе и сказал:
 - Через неделю вы едете на RuCTF!
Так появилась команда WildRide (правда мы долго не могли определиться с
названием).

Я тогда и не думал что это станет неотъемлимой частью моей жизни. Конечно, всё
это захватывает - ковыряние в *nix'ах, написание скриптов, знакомство с
эксплойтами для Windows, запуск ettercap в локальной сети общежития. Но кто бы
мне, студенту второго курса Компьютерной Безопасности, сказал что через пять
лет я всё ещё порою буду ночи напролет сидеть в скайпе с незнакомыми людьми
под выдуманными никами и заниматься взломом различных сервисов, соревнуясь с
другими командами? Ха-ха, я бы ему ни за что не поверил.

Но я знаю что среди вас найдется ещё с десяток человек, с кем такое бывает. Я
ведь прав?

Есть тут кто-нибудь, кто участвовал в CodeGate?
// странно, а кто же тогда занял там 2-е место пару недель назад? //

А в iCTF?
// а где команда PeterPen? //

Хм, тогда может в RuCTF Quals, кто-нибудь участвовал? Тоже вроде недавно
были такие соревнования...
// ах, ну да, вы же все там участвовали :-D //

Соревнования которые пройдут завтра это последний RuCTF, в котором я участвую
в качестве члена команды игроков. // Ведь RuCTF это студенческие соревнования.
А я уже два года как не студент и работаю в Яндексе. // И я очень рад, что мне
предоставился случай выступить на этой сцене от имени Яндекса, будучи
участником соревнований.

---

Что же такое CTF?.. Что же такое Capture the Flag для меня? Наверное вы все
испытывали это чувство, когда вы решаете какой-то сложный таск,
решаете-решаете его... Пишете скрипт который ищет путь в 3D лабиринте (а потом
гадаете, где же ответ?!). Вытаскиваете биты, заботливо упрятанные в PNG'шку
разработчиком таска, только для того чтобы найти следущую PNG'шку в которой
биты расположены другим образом. Какой кайф, когда результаты ваших
стараний складываются в ответ! Люди получают удовольствие от любого
завершенного дела, но участие в CTF дает вам нечто особенное.

---

Самое главное, что дает нам Capture the Flag, это уникальный опыт:
* решение тасков, которые может решить только человек думающий как вы
* поиск уязвимостей
* работа с различными системами и технологиями (как использующимися
повсеместно, так и теми, которые называют маргинальными)
* взлома и защита веб-сервисов
* разработка безопасных и не безопасных приложений

---

Что главное в разработке безопасных приложений?

// картинка //

Конечно же — не изобретать велосипедов. Но, как вы видите, в Яндексе их очень
много. Это связано со спецификой разработки в Яндексе...


Вот поэтому нам очень важно следить за своими сервисами, и каждый новый
велосипед проходит через службу информационной безопасности.

---

Откуда берутся уязвимости на CTF? Их придумывают разработчики. Ну, конечно,
они их придумывают не с нуля - все мы знаем стандартные типы уязвимостей,
где их искать, откуда они берутся, как эксплуатируются...

// Так какие типы уязвимостей вы знаете? //

---

И так, 90% сервисов на CTF состоят из различных велосипедов, написанных
организаторами, и они содержат многие из этих типов уязвимостей. Большинство
этих уязвимостей связаны с данными, поступающими от пользователей. Это
различные инъекции, CSRF, переполнения буфера... Но на Capture the Flag иногда
встречаются и бэкдоры, оставленные специально - странички со списком флагов,
ручки, исполняющие всё что им скажут через командную оболочку. Бывают и
зашитые в систему бэкдоры - например ssh-ключи у пользователей, или процессы
скрываемые руткитом, не связанные ни с одним сервисом (хотя на RuCTF такие -
редкость).

---

От большинства таких уязвимостей можно избавиться если соблюдать элементарные
правила. Как мы уже отметили - главный принцип - не нужно писать свои
велосипеды. Меньше кода - меньше уязвимостей. При написании сервисов обычно
используются различные стандартные библиотеки и фреймворки. Под каждую задачу
можно выбрать подходящий инструмент, фреймворк в котором будет реализована
большая часть необходимой функциональности. В идеале - вам должно быть нужно
просто реализовать основную логику приложения, желательно с использованием
декларативной парадигмы программирования. И никаких стандартных протоколов,
никаких методов аутентификации пользователей, ничего не нужно писать
самостоятельно.

Но если вам всё-таки понадобилась какая-то дополнительная функциональность, не
предоставляемая фреймворком и стандартными библиотеками для языка, поищите
надежную готовую реализацию в сторонних библиотеках. Но не спешите хватать
первую попавшуюся - любой сторонний код необходимо проверить, изучить
документацию, посмотреть состояние тестов, наличие недокументированных
возможностей.

Для Python например существует отличная библиотека lxml. И она довольно
популярна. Но многие не знают, что при передаче в lxml.etree.parse не
проверенного XML-файла от злоумышленника, эта библиотека позволяет ему
включать в документ локальные файлы и, следовательно, получать к ним доступ.

Это поведение, конечно, описано в документации. Но кто её читает? :-)
Читать документацию - тоже важное правило. Иначе откуда вы узнаете, что
формировать SQL запросы руками - чревато получением SQL-инъекций в коде?

Хотя, возможно про SQL запросы вам успеет подсказать кто-то более опытный, кто
уже прочитал документацию от корки до корки.

---



---

Заключение.

Я работаю в Яндексе уже два года, занимаюсь разработкой сразу нескольких
сервисов. Нет, я конечно понимаю, что в коде который написан мной тоже есть
уязвимости, и что наверняка когда-нибудь, кто-нибудь их найдет. Но за время
моей работы ко мне ещё ни разу не приходили письма из службы безопасности.

У моего знакомого, из службы информационной защиты ГазПрома (он следит за
соблюдением политик безопасности), есть девиз:
- Если вас не за что наказать, это не ваша заслуга, это наше упущение.

Но мне хочется верить, что соблюдение указанных в моем докладе правил при
разработке, сыграло свою роль в отсутствии писем счастья в моем корпоративном
ящике.

Надеюсь что и вам эти правила помогут.

Спасибо за внимание. Если у кого-то есть вопросы по докладу или про Яндекс у
нас есть 5-10 минут.

---
